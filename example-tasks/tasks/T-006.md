# T-006

  - steps:
      - [x] Create SQL function for time proximity sorting
      - [x] Update frontend to use SQL function
      - [x] Remove JavaScript sorting logic
      - [x] Test with large datasets
      - [x] Verify performance improvements
    ```md
    Implement transaction sorting by time proximity in the database
    instead of doing it in JavaScript on the frontend.
    
    **Problem:**
    - Sorting was being done in JavaScript after fetching all transactions
    - Heavy processing on the client, especially with many transactions
    - Did not take advantage of database indexes
    
    **Implemented solution:**
    1. **SQL Function**: Created `get_transactions_by_time_proximity()` that:
       - Receives datetime_utc reference
       - Calculates absolute difference in seconds for each transaction
       - Sorts by proximity (closest first)
       - Filters only transactions with non-null datetime_utc
       - Supports exclusion of transactions already in groups
       - Supports filtering by datetime_utc interval
    
    2. **Simplified frontend**: 
       - Uses database RPC to call the SQL function
       - Removes all sorting logic from frontend
       - Keeps only value and time filters on the client
    
    **Advantages:**
    - Performance: Sorting in database (optimized)
    - Scalability: Works well with many records
    - Less data transferred: Sorts before sending
    - Uses database indexes on datetime_utc
    - Simpler code: No fallbacks, only datetime_utc
    ```
